---
title: "SFAplus compared to other existing SFA packages"
author: "Vaclav Hausenblas"
date: "2016-04-01"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

### Example dataset

Lets generate some randomly simulated production data,

```{r}
source("simulate_data.R")

dtDT <- as.data.table(sim_data(500))

```

and explore the production data and simulated inefficiency term.

```{r, fig.width = 10, fig.height = 10}
# require(GGally)
# ggpairs(dtDT)

plot(dtDT)
```

```{r}
hist(dtDT$y)
hist(dtDT$u)
hist(dtDT$eps)

```

## OLS model

We might be interested in simple OLS model for LR test (and starting values of parameters).

```{r}

lmfit <- lm(y ~ x1 + x2 + z1 + z2, data = dtDT)
summary(lmfit)

```

## SFA model

```{r}
est <- SFAplus::sfa.fit(y = dtDT$y,
                        X = as.matrix(dtDT[, .(x1, x2)]),
                        Z = as.matrix(dtDT[, .(z1, z2)]),
                        spec = "bc95",
                        deb = F,
                        opt_method = "BFGS"
                        # control_opt = list(maxit = 300, trace = T)
)
print(est)
```


<!-- ### benchmark with sfa package -->

<!-- ```{r} -->
<!-- require(sfa) -->

<!-- summary(sfa::sfa(y ~ x1 + x2, -->
<!--                  data = as.data.frame(data1), -->
<!--                  fun = "tnormal", -->
<!--                  form = "production")) -->

<!-- ``` -->


### benchmark with frontier package methods

```{r}
require(frontier)

frontest <- frontier::sfa(y ~ x1 + x2 | z1 + z2,
                          data = dtDT,
                          ineffDecrease = T,
                          truncNorm = T,
                          muBound = 0,
                          maxit = 100)

summary(frontest)
lrtest(frontest)

```

